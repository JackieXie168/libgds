<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>GDS - Generic Data Structures: cli_ctx.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>cli_ctx.c</h1><a href="cli__ctx_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">// ==================================================================</span>
00002 <span class="comment">// @(#)cli_ctx.h</span>
00003 <span class="comment">//</span>
00004 <span class="comment">// @author Bruno Quoitin (bqu@infonet.fundp.ac.be)</span>
00005 <span class="comment">// @date 25/06/2003</span>
00006 <span class="comment">// @lastdate 25/07/2003</span>
00007 <span class="comment">// ==================================================================</span>
00008 
00009 <span class="preprocessor">#include &lt;<a class="code" href="cli_8h.html">cli.h</a>&gt;</span>
00010 <span class="preprocessor">#include &lt;<a class="code" href="cli__ctx_8h.html">cli_ctx.h</a>&gt;</span>
00011 <span class="preprocessor">#include &lt;<a class="code" href="memory_8h.html">memory.h</a>&gt;</span>
00012 
<a name="l00013"></a><a class="code" href="cli__ctx_8c.html#a0">00013</a> <span class="preprocessor">#define CLI_MAX_CONTEXT 16</span>
00014 <span class="preprocessor"></span>
00015 <span class="comment">// ----- cli_context_item_create ------------------------------------</span>
<a name="l00016"></a><a class="code" href="cli__ctx_8c.html#a1">00016</a> <a class="code" href="structSCliCtxItem.html">SCliCtxItem</a> * <a class="code" href="cli__ctx_8c.html#a1">cli_context_item_create</a>(<span class="keywordtype">void</span> * pItem,
00017                                       <a class="code" href="structSCliCmd.html">SCliCmd</a> * pCmd,
00018                                       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uNumParams)
00019 {
00020   <a class="code" href="structSCliCtxItem.html">SCliCtxItem</a> * pCtxItem=
00021     (<a class="code" href="structSCliCtxItem.html">SCliCtxItem</a> *) <a class="code" href="memory_8h.html#a0">MALLOC</a>(<span class="keyword">sizeof</span>(<a class="code" href="structSCliCtxItem.html">SCliCtxItem</a>));
00022   pCtxItem-&gt;<a class="code" href="structSCliCtxItem.html#o0">pItem</a>= pItem;
00023   pCtxItem-&gt;<a class="code" href="structSCliCtxItem.html#o1">pCmd</a>= pCmd;
00024   pCtxItem-&gt;<a class="code" href="structSCliCtxItem.html#o2">uNumParams</a>= uNumParams;
00025   <span class="keywordflow">return</span> pCtxItem;
00026 }
00027 
00028 <span class="comment">// ----- cli_context_item_destroy -----------------------------------</span>
<a name="l00029"></a><a class="code" href="cli__ctx_8c.html#a2">00029</a> <span class="keywordtype">void</span> <a class="code" href="cli__ctx_8c.html#a2">cli_context_item_destroy</a>(<a class="code" href="structSCliCtxItem.html">SCliCtxItem</a> ** ppCtxItem)
00030 {
00031   <span class="keywordflow">if</span> (*ppCtxItem != NULL) {
00032     <span class="keywordflow">if</span> ((*ppCtxItem)-&gt;pCmd-&gt;fCtxDestroy != NULL)
00033       (*ppCtxItem)-&gt;pCmd-&gt;fCtxDestroy(&amp;(*ppCtxItem)-&gt;pItem);
00034     <a class="code" href="memory_8h.html#a2">FREE</a>(*ppCtxItem);
00035     *ppCtxItem= NULL;
00036   }
00037 }
00038 
00039 <span class="comment">// ----- cli_context_create -----------------------------------------</span>
<a name="l00043"></a><a class="code" href="cli__ctx_8c.html#a3">00043</a> <span class="comment"></span><a class="code" href="structSCliContext.html">SCliContext</a> * <a class="code" href="cli__ctx_8c.html#a3">cli_context_create</a>()
00044 {
00045   <a class="code" href="structSCliContext.html">SCliContext</a> * pContext=
00046     (<a class="code" href="structSCliContext.html">SCliContext</a> *) <a class="code" href="memory_8h.html#a0">MALLOC</a>(<span class="keyword">sizeof</span>(<a class="code" href="structSCliContext.html">SCliContext</a>));
00047   pContext-&gt;<a class="code" href="structSCliContext.html#o0">pStack</a>= <a class="code" href="stack_8c.html#a0">stack_create</a>(<a class="code" href="cli__ctx_8c.html#a0">CLI_MAX_CONTEXT</a>);
00048   pContext-&gt;<a class="code" href="structSCliContext.html#o2">pTokens</a>= <a class="code" href="tokenizer_8c.html#a9">tokens_create</a>();
00049   pContext-&gt;<a class="code" href="structSCliContext.html#o1">uSavedDepth</a>= 0;
00050   <span class="keywordflow">return</span> pContext;
00051 }
00052 
00053 <span class="comment">// ----- cli_context_create -----------------------------------------</span>
<a name="l00057"></a><a class="code" href="cli__ctx_8c.html#a4">00057</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="cli__ctx_8c.html#a4">cli_context_destroy</a>(<a class="code" href="structSCliContext.html">SCliContext</a> ** ppContext)
00058 {
00059   <span class="keywordtype">int</span> iIndex;
00060 
00061   <span class="keywordflow">if</span> (*ppContext != NULL) {
00062     <span class="keywordflow">for</span> (iIndex= 0; iIndex &lt; (*ppContext)-&gt;pStack-&gt;iDepth; iIndex++) {
00063       <a class="code" href="structSCliCtxItem.html">SCliCtxItem</a> * pItem=
00064         (<a class="code" href="structSCliCtxItem.html">SCliCtxItem</a> *) <a class="code" href="stack_8c.html#a5">stack_get_at</a>((*ppContext)-&gt;pStack, iIndex);
00065       <a class="code" href="cli__ctx_8c.html#a2">cli_context_item_destroy</a>(&amp;pItem);
00066     }
00067     <a class="code" href="stack_8c.html#a1">stack_destroy</a>(&amp;(*ppContext)-&gt;pStack);
00068     <a class="code" href="tokenizer_8c.html#a10">tokens_destroy</a>(&amp;(*ppContext)-&gt;pTokens);
00069     <a class="code" href="memory_8h.html#a2">FREE</a>(*ppContext);
00070     *ppContext= NULL;
00071   }
00072 }
00073 
00074 <span class="comment">// ----- cli_context_depth ------------------------------------------</span>
<a name="l00078"></a><a class="code" href="cli__ctx_8c.html#a5">00078</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="cli__ctx_8c.html#a5">cli_context_depth</a>(<a class="code" href="structSCliContext.html">SCliContext</a> * pContext)
00079 {
00080   <span class="keywordflow">return</span> <a class="code" href="stack_8c.html#a6">stack_depth</a>(pContext-&gt;<a class="code" href="structSCliContext.html#o0">pStack</a>);
00081 }
00082 
00083 <span class="comment">// ----- cli_context_is_empty ---------------------------------------</span>
<a name="l00087"></a><a class="code" href="cli__ctx_8c.html#a6">00087</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="cli__ctx_8c.html#a6">cli_context_is_empty</a>(<a class="code" href="structSCliContext.html">SCliContext</a> * pContext)
00088 {
00089   <span class="keywordflow">return</span> <a class="code" href="stack_8c.html#a7">stack_is_empty</a>(pContext-&gt;<a class="code" href="structSCliContext.html#o0">pStack</a>);
00090 }
00091 
00092 <span class="comment">// ----- cli_context_push -------------------------------------------</span>
<a name="l00096"></a><a class="code" href="cli__ctx_8c.html#a7">00096</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="cli__ctx_8c.html#a7">cli_context_push</a>(<a class="code" href="structSCliContext.html">SCliContext</a> * pContext, <span class="keywordtype">void</span> * pItem,
00097                      <a class="code" href="structSCliCmd.html">SCliCmd</a> * pCmd)
00098 {
00099   <a class="code" href="structSCliCtxItem.html">SCliCtxItem</a> * pCtxItem=
00100     <a class="code" href="cli__ctx_8c.html#a1">cli_context_item_create</a>(pItem, pCmd,
00101                             <a class="code" href="tokenizer_8c.html#a13">tokens_get_num</a>(pContext-&gt;<a class="code" href="structSCliContext.html#o2">pTokens</a>));
00102   <span class="keywordflow">return</span> <a class="code" href="stack_8c.html#a2">stack_push</a>(pContext-&gt;<a class="code" href="structSCliContext.html#o0">pStack</a>, pCtxItem);
00103 }
00104 
00105 <span class="comment">// ----- cli_context_pop --------------------------------------------</span>
<a name="l00109"></a><a class="code" href="cli__ctx_8c.html#a8">00109</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="cli__ctx_8c.html#a8">cli_context_pop</a>(<a class="code" href="structSCliContext.html">SCliContext</a> * pContext)
00110 {
00111   <a class="code" href="structSCliCtxItem.html">SCliCtxItem</a> * pCtxItem= (<a class="code" href="structSCliCtxItem.html">SCliCtxItem</a> *) <a class="code" href="stack_8c.html#a3">stack_pop</a>(pContext-&gt;<a class="code" href="structSCliContext.html#o0">pStack</a>);
00112   <a class="code" href="cli__ctx_8c.html#a2">cli_context_item_destroy</a>(&amp;pCtxItem);
00113 }
00114 
00115 <span class="comment">// ----- cli_context_top ---------------------------------------------</span>
<a name="l00119"></a><a class="code" href="cli__ctx_8c.html#a9">00119</a> <span class="comment"></span><a class="code" href="structSCliCtxItem.html">SCliCtxItem</a> * <a class="code" href="cli__ctx_8c.html#a9">cli_context_top</a>(<a class="code" href="structSCliContext.html">SCliContext</a> * pContext)
00120 {
00121   <span class="keywordflow">return</span> (<a class="code" href="structSCliCtxItem.html">SCliCtxItem</a> *) <a class="code" href="stack_8c.html#a4">stack_top</a>(pContext-&gt;<a class="code" href="structSCliContext.html#o0">pStack</a>);
00122 }
00123 
00124 <span class="comment">// ----- cli_context_get_at ------------------------------------------</span>
<a name="l00128"></a><a class="code" href="cli__ctx_8c.html#a10">00128</a> <span class="comment"></span><a class="code" href="structSCliCtxItem.html">SCliCtxItem</a> * <a class="code" href="cli__ctx_8c.html#a10">cli_context_get_at</a>(<a class="code" href="structSCliContext.html">SCliContext</a> * pContext, uint32_t uIndex)
00129 {
00130   <span class="keywordflow">return</span> (<a class="code" href="structSCliCtxItem.html">SCliCtxItem</a> *) <a class="code" href="stack_8c.html#a5">stack_get_at</a>(pContext-&gt;<a class="code" href="structSCliContext.html#o0">pStack</a>, uIndex);
00131 }
00132 
00133 <span class="comment">// ----- cli_context_get_item_at ------------------------------------</span>
<a name="l00137"></a><a class="code" href="cli__ctx_8c.html#a11">00137</a> <span class="comment"></span><a class="code" href="structSCliCtxItem.html">SCliCtxItem</a> * <a class="code" href="cli__ctx_8c.html#a11">cli_context_get_item_at</a>(<a class="code" href="structSCliContext.html">SCliContext</a> * pContext, uint32_t uIndex)
00138 {
00139   <a class="code" href="structSCliCtxItem.html">SCliCtxItem</a> * pCtxItem=
00140     (<a class="code" href="structSCliCtxItem.html">SCliCtxItem</a> *) <a class="code" href="stack_8c.html#a5">stack_get_at</a>(pContext-&gt;<a class="code" href="structSCliContext.html#o0">pStack</a>, uIndex);
00141   <span class="keywordflow">if</span> (pCtxItem != NULL)
00142     <span class="keywordflow">return</span> pCtxItem-&gt;<a class="code" href="structSCliCtxItem.html#o0">pItem</a>;
00143   <span class="keywordflow">return</span> NULL;
00144 }
00145 
00146 <span class="comment">// ----- cli_context_get_item_at_top --------------------------------</span>
<a name="l00150"></a><a class="code" href="cli__ctx_8c.html#a12">00150</a> <span class="comment"></span><a class="code" href="structSCliCtxItem.html">SCliCtxItem</a> * <a class="code" href="cli__ctx_8c.html#a12">cli_context_get_item_at_top</a>(<a class="code" href="structSCliContext.html">SCliContext</a> * pContext)
00151 {
00152   <span class="keywordflow">if</span> (!<a class="code" href="cli__ctx_8c.html#a6">cli_context_is_empty</a>(pContext))
00153     <span class="keywordflow">return</span> <a class="code" href="cli__ctx_8c.html#a11">cli_context_get_item_at</a>(pContext, <a class="code" href="cli__ctx_8c.html#a5">cli_context_depth</a>(pContext)-1);
00154   <span class="keywordflow">return</span> NULL;
00155 }
00156 
00157 <span class="comment">// ----- cli_context_add_token_copy ---------------------------------</span>
<a name="l00161"></a><a class="code" href="cli__ctx_8c.html#a13">00161</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="cli__ctx_8c.html#a13">cli_context_add_token_copy</a>(<a class="code" href="structSCliContext.html">SCliContext</a> * pContext, <span class="keywordtype">char</span> * pcToken)
00162 {
00163   <span class="keywordflow">return</span> <a class="code" href="tokenizer_8c.html#a12">tokens_add_copy</a>(pContext-&gt;<a class="code" href="structSCliContext.html#o2">pTokens</a>, pcToken);
00164 }
00165 
00166 <span class="comment">// ----- cli_context_clear ------------------------------------------</span>
<a name="l00170"></a><a class="code" href="cli__ctx_8c.html#a14">00170</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="cli__ctx_8c.html#a14">cli_context_clear</a>(<a class="code" href="structSCliContext.html">SCliContext</a> * pContext)
00171 {
00172   <span class="keywordflow">while</span> (<a class="code" href="cli__ctx_8c.html#a5">cli_context_depth</a>(pContext) &gt; 0)
00173     <a class="code" href="cli__ctx_8c.html#a8">cli_context_pop</a>(pContext);
00174   <a class="code" href="tokenizer_8c.html#a10">tokens_destroy</a>(&amp;pContext-&gt;<a class="code" href="structSCliContext.html#o2">pTokens</a>);
00175   pContext-&gt;<a class="code" href="structSCliContext.html#o2">pTokens</a>= <a class="code" href="tokenizer_8c.html#a9">tokens_create</a>();
00176   pContext-&gt;<a class="code" href="structSCliContext.html#o1">uSavedDepth</a>= 0;
00177 }
00178 
00179 <span class="comment">// ----- cli_context_backtrack --------------------------------------</span>
<a name="l00183"></a><a class="code" href="cli__ctx_8c.html#a15">00183</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="cli__ctx_8c.html#a15">cli_context_backtrack</a>(<a class="code" href="structSCliContext.html">SCliContext</a> * pContext)
00184 {
00185   <a class="code" href="cli__ctx_8c.html#a8">cli_context_pop</a>(pContext);
00186   <span class="keywordflow">if</span> (!<a class="code" href="cli__ctx_8c.html#a6">cli_context_is_empty</a>(pContext)) {
00187     fprintf(stderr, <span class="stringliteral">"backtrack parameters\n"</span>);
00188   }
00189 }
00190 
00191 <span class="comment">// ----- cli_context_save_depth -------------------------------------</span>
<a name="l00195"></a><a class="code" href="cli__ctx_8c.html#a16">00195</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="cli__ctx_8c.html#a16">cli_context_save_depth</a>(<a class="code" href="structSCliContext.html">SCliContext</a> * pContext)
00196 {
00197   pContext-&gt;<a class="code" href="structSCliContext.html#o1">uSavedDepth</a>= <a class="code" href="stack_8c.html#a6">stack_depth</a>(pContext-&gt;<a class="code" href="structSCliContext.html#o0">pStack</a>);
00198 }
00199 
00200 <span class="comment">// ----- cli_context_restore_depth ----------------------------------</span>
<a name="l00204"></a><a class="code" href="cli__ctx_8c.html#a17">00204</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="cli__ctx_8c.html#a17">cli_context_restore_depth</a>(<a class="code" href="structSCliContext.html">SCliContext</a> * pContext)
00205 {
00206   <span class="keywordflow">while</span> (<a class="code" href="cli__ctx_8c.html#a5">cli_context_depth</a>(pContext) &gt; pContext-&gt;<a class="code" href="structSCliContext.html#o1">uSavedDepth</a>)
00207     <a class="code" href="cli__ctx_8c.html#a8">cli_context_pop</a>(pContext);
00208 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jul 30 15:56:47 2003 for GDS - Generic Data Structures by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.2 </small></address>
</body>
</html>
